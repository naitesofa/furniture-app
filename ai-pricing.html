<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI报价 - 小麦</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="ai-pricing.css">
  <style>
    /* 设置页面样式 */
    #settingsPage {
      overflow-y: auto;
      z-index: 50; /* 确保在输入框之上 */
    }
    
    .settings-header {
      background-color: var(--ai-color);
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .settings-section {
      padding: 0 16px;
      margin-bottom: 16px;
    }
    
    .settings-section-title {
      font-size: 11px;
      font-weight: 500;
      color: #889096;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin: 14px 0 6px;
      padding: 0 16px;
    }
    
    .settings-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }
    
    .settings-item:last-child {
      border-bottom: none;
    }
    
    .settings-item-left {
      display: flex;
      align-items: center;
      flex: 1;
    }
    
    .settings-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 10px;
      flex-shrink: 0;
    }
    
    .settings-item-content {
      flex: 1;
    }
    
    .settings-item-title {
      font-weight: 500;
      margin-bottom: 0;
      font-size: 15px;
    }
    
    .settings-item-desc {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 1px;
    }
    
    .settings-item-right {
      display: flex;
      align-items: center;
    }
    
    .settings-item-value {
      font-size: 13px;
      color: var(--text-secondary);
      margin-right: 8px;
    }
    
    .chevron-icon {
      color: var(--text-secondary);
      opacity: 0.5;
    }
    
    .user-avatar-small {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background-color: rgba(59, 130, 246, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 8px;
    }
    
    /* 开关按钮样式 */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 20px;
    }
    
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #e5e7eb;
      transition: .3s;
      border-radius: 20px;
    }
    
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    
    input:checked + .toggle-slider {
      background-color: var(--main-color);
    }
    
    input:checked + .toggle-slider:before {
      transform: translateX(20px);
    }
  </style>
</head>
<body class="h-screen flex flex-col">
  <!-- 顶部状态栏 -->
  <header class="pt-2 px-4 pb-4">
    <div class="flex items-center justify-between">
      <button class="p-2" id="backButton">
        <i class="fas fa-arrow-left text-xl"></i>
      </button>
      <h1 class="text-xl font-medium">AI报价</h1>
      <button class="p-2" id="menuButton">
        <img src="images/fenlei.svg" alt="菜单" class="w-6 h-6">
      </button>
    </div>
  </header>

  <!-- 功能菜单 (默认隐藏) -->
  <div id="functionMenu" class="fixed right-0 top-0 h-full bg-mintfog shadow-lg z-50 transform translate-x-full transition-all duration-300 w-full">
    <div class="flex flex-col h-full">
      <!-- 菜单头部 -->
      <div class="menu-header">
        <div class="menu-header-content">
          <!-- 用户信息和关闭按钮区域 -->
          <div class="menu-header-row">
            <div class="user-profile">
              <div class="user-avatar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
              </div>
              <div class="user-info">
                <div class="user-name text-neutral-gray">访客用户</div>
              </div>
            </div>
            <button id="closeMenuButton" class="menu-close-btn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          </div>
        </div>
      </div>
              
      <!-- 菜单内容 -->
      <div class="flex-1 overflow-y-auto">
        <div class="px-2 pt-1">
          <div class="menu-section mb-2">
            <h4 class="menu-section-title">智能助手</h4>
            <ul>
              <li>
                <a href="ai-assistant.html" class="menu-item">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                  </div>
                  <span>新对话</span>
                </a>
              </li>
              <li>
                <a href="ai-pricing.html" class="menu-item active">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2a9d8f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                      <line x1="12" y1="4" x2="12" y2="20"></line>
                      <path d="M18 8h.01M18 12h.01M18 16h.01"></path>
                      <path d="M6 8h4M6 12h4M6 16h4"></path>
                    </svg>
                  </div>
                  <span>AI报价</span>
                  <span class="current-indicator"></span>
                </a>
              </li>
              <li>
                <a href="ai-design.html" class="menu-item">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
                      <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
                      <path d="M2 2l7.586 7.586"></path>
                      <circle cx="11" cy="11" r="2"></circle>
                    </svg>
                  </div>
                  <span>AI设计</span>
                </a>
              </li>
            </ul>
          </div>
          
          <div class="menu-section mb-2">
            <h4 class="menu-section-title">高级功能</h4>
            <ul>
              <li>
                <a href="ai-diagnosis.html" class="menu-item">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                      <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                  </div>
                  <span>户型诊断</span>
                </a>
              </li>
              <li>
                <a href="ai-video.html" class="menu-item">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect>
                      <line x1="7" y1="2" x2="7" y2="22"></line>
                      <line x1="17" y1="2" x2="17" y2="22"></line>
                      <line x1="2" y1="12" x2="22" y2="12"></line>
                      <line x1="2" y1="7" x2="7" y2="7"></line>
                      <line x1="2" y1="17" x2="7" y2="17"></line>
                      <line x1="17" y1="17" x2="22" y2="17"></line>
                      <line x1="17" y1="7" x2="22" y2="7"></line>
                    </svg>
                  </div>
                  <span>图生视频</span>
                </a>
              </li>
            </ul>
          </div>
          
          <!-- 分隔线 -->
          <div class="border-t border-gray-100 my-1 mx-3"></div>
          
          <!-- 设置部分 -->
          <div class="menu-section mb-2">
            <h4 class="menu-section-title">其他</h4>
            <ul>
              <li>
                <a href="#" class="menu-item" id="settingsMenuItem">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <circle cx="12" cy="12" r="3"></circle>
                      <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                  </div>
                  <span>设置</span>
                </a>
              </li>
            </ul>
          </div>
          
          <!-- 分隔线 -->
          <div class="border-t border-gray-100 my-1 mx-3"></div>
          
          <!-- 最近对话部分 -->
          <div class="menu-section mb-4">
            <h4 class="menu-section-title">最近对话</h4>
            <ul>
              <li>
                <a href="#" class="menu-item recent-chat">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                  </div>
                  <div class="flex-1 overflow-hidden">
                    <div class="font-medium text-sm">装修设计流行趋势</div>
                    <div class="text-xs text-gray-500 truncate">今天 15:04</div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#" class="menu-item recent-chat">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                  </div>
                  <div class="flex-1 overflow-hidden">
                    <div class="font-medium text-sm">沙发价格咨询</div>
                    <div class="text-xs text-gray-500 truncate">昨天 10:23</div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#" class="menu-item recent-chat">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                  </div>
                  <div class="flex-1 overflow-hidden">
                    <div class="font-medium text-sm">法式风格客厅设计</div>
                    <div class="text-xs text-gray-500 truncate">3天前</div>
                  </div>
                </a>
              </li>
              <!-- 查看更多按钮 -->
              <li>
                <a href="#" class="menu-item" id="viewAllChatsBtn">
                  <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#889096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                      <path d="M12 2v10l4 4"></path>
                    </svg>
                  </div>
                  <span>查看更多</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 菜单遮罩层 -->
  <div id="menuOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300 opacity-0"></div>

  <!-- 设置页面 (默认隐藏) -->
  <div id="settingsPage" class="fixed inset-0 bg-white z-40 transform translate-y-full transition-all duration-300">
    <div class="flex flex-col h-full">
      <!-- 设置页面头部 -->
      <div class="settings-header">
        <div class="flex items-center justify-between px-4 py-3">
          <button id="closeSettingsButton" class="p-2 rounded-full bg-gray-100">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
          <h3 class="text-xl font-medium">设置</h3>
          <div class="w-10"></div> <!-- 占位元素保持标题居中 -->
        </div>
      </div>
      
      <!-- 设置内容区域 -->
      <div class="flex-1 overflow-y-auto">
        <!-- 个人信息设置 -->
        <div class="settings-section">
          <h4 class="settings-section-title">个人信息</h4>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-blue-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">头像</div>
                <div class="settings-item-desc">修改您的个人头像</div>
              </div>
            </div>
            <div class="settings-item-right">
              <div class="user-avatar-small">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
              </div>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-blue-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">昵称</div>
                <div class="settings-item-desc">修改您的显示昵称</div>
              </div>
            </div>
            <div class="settings-item-right">
              <div class="settings-item-value">访客用户</div>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- 界面偏好 -->
        <div class="settings-section">
          <h4 class="settings-section-title">界面偏好</h4>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-purple-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="5"></circle>
                  <line x1="12" y1="1" x2="12" y2="3"></line>
                  <line x1="12" y1="21" x2="12" y2="23"></line>
                  <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                  <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                  <line x1="1" y1="12" x2="3" y2="12"></line>
                  <line x1="21" y1="12" x2="23" y2="12"></line>
                  <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                  <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">深色模式</div>
                <div class="settings-item-desc">切换深色/浅色显示</div>
              </div>
            </div>
            <div class="settings-item-right">
              <label class="toggle-switch">
                <input type="checkbox" id="darkModeToggle">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-purple-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">显示设置</div>
                <div class="settings-item-desc">字体大小、气泡样式</div>
              </div>
            </div>
            <div class="settings-item-right">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- 通知与隐私设置 -->
        <div class="settings-section">
          <h4 class="settings-section-title">通知与隐私</h4>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-green-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                  <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">通知设置</div>
                <div class="settings-item-desc">消息和报价完成提醒</div>
              </div>
            </div>
            <div class="settings-item-right">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-red-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">隐私与数据</div>
                <div class="settings-item-desc">历史记录和数据共享</div>
              </div>
            </div>
            <div class="settings-item-right">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- 语言和关于 -->
        <div class="settings-section">
          <h4 class="settings-section-title">其他设置</h4>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-yellow-50">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="2" y1="12" x2="22" y2="12"></line>
                  <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">语言</div>
                <div class="settings-item-desc">当前：中文</div>
              </div>
            </div>
            <div class="settings-item-right">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
          <div class="settings-item">
            <div class="settings-item-left">
              <div class="settings-icon bg-gray-100">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
              </div>
              <div class="settings-item-content">
                <div class="settings-item-title">关于与帮助</div>
                <div class="settings-item-desc">使用教程、版本信息</div>
              </div>
            </div>
            <div class="settings-item-right">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 主要内容区域 -->
  <main id="mainContainer" class="flex-1 flex flex-col justify-center overflow-y-auto px-4">

    <!-- 对话历史区 -->
    <div id="chatHistory">
      <!-- 对话气泡将在这里生成 -->
    </div>
    
    <!-- 动态输入区: 初始状态在文档流中，之后会固定到底部 -->
    <div id="queryInputContainer" class="query-input-container pt-2 pb-4">
      <!-- 底部遮罩输入区的标题和关闭按钮 -->
      <!-- <div class="sheet-header hidden">
        <div class="sheet-title">编辑报价需求</div>
        <button id="sheetCloseBtn" class="sheet-close-btn">
          <i class="fas fa-times"></i>
        </button>
      </div> -->
      
      <!-- AI报价介绍 -->
      <div class="my-4 text-center introduction hidden">
        <!-- <h2 class="text-xl font-semibold text-gray-800 mb-1">AI 报价</h2> -->
        <p class="text-sm text-gray-500">输入您的需求，即刻获取专属预算</p>
      </div>

      <!-- Category Pills -->
      <div class="pills-container mb-1">
        <div class="feature-pills" style="padding-bottom: 0px;">
          <button data-target="renovation" class="feature-pill active">装修报价</button>
          <button data-target="sofa" class="feature-pill">沙发报价</button>
          <button data-target="custom" class="feature-pill">全屋定制</button>
          <button data-target="furniture" class="feature-pill">成品家具</button>
          <button data-target="appliance" class="feature-pill">全屋家电</button>
        </div>
      </div>

      <!-- 动态输入区 -->
      <div id="dynamicInputArea" class="px-1">
        <!-- 装修报价模板 (默认显示) -->
        <div id="renovation-template" class="pricing-template">
          <div class="pricing-card-new">
            <!-- 城市 -->
            <div class="card-item" data-type="city" data-title="城市" data-default="天津">
              <div class="card-item-label">
                <i class="fas fa-map-marker-alt"></i>
                <span>城市</span>
              </div>
              <div class="card-item-control">
                <span class="value-text">天津</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>

            <!-- 套内面积 -->
            <div class="card-item" data-type="area" data-default="100">
              <div class="card-item-label">
                <i class="fas fa-ruler-combined"></i>
                <span>套内面积</span>
              </div>
              <div class="card-item-control area-input-control">
                <input type="number" class="area-input" value="100" min="1" max="1000">
                <span class="unit-text">㎡</span>
              </div>
            </div>
            
            <!-- 户型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-home"></i>
                <span>户型</span>
              </div>
              <div class="stepper-container">
                <div class="stepper">
                  <span class="stepper-label">房</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="room">-</button>
                    <span class="stepper-value" data-type="room" data-default="3">3</span>
                    <button class="stepper-btn" data-action="plus" data-target="room">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厅</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="hall">-</button>
                    <span class="stepper-value" data-type="hall" data-default="2">2</span>
                    <button class="stepper-btn" data-action="plus" data-target="hall">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">卫</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="bathroom">-</button>
                    <span class="stepper-value" data-type="bathroom" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="bathroom">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厨</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="kitchen">-</button>
                    <span class="stepper-value" data-type="kitchen" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="kitchen">+</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- 装修类型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-brush"></i>
                <span>装修类型</span>
              </div>
              <div class="segmented-control-new" data-type="renovationType">
                <button class="segmented-btn-new active" data-value="精装房">精装房</button>
                <button class="segmented-btn-new" data-value="简装房">简装</button>
                <button class="segmented-btn-new" data-value="毛坯房">毛坯</button>
                <button class="segmented-btn-new" data-value="旧房翻新">翻新</button>
              </div>
            </div>

            <!-- 主操作按钮 -->
            <div class="card-action-footer">
              <button class="send-btn-new primary">
                <i class="fas fa-magic"></i>
                <span>获取AI报价</span>
              </button>
            </div>
          </div>
        </div>
        <!-- 全屋定制模板 -->
        <div id="custom-template" class="pricing-template hidden">
          <div class="pricing-card-new">
            <!-- 城市 -->
            <div class="card-item" data-type="city" data-title="城市" data-default="天津">
              <div class="card-item-label">
                <i class="fas fa-map-marker-alt"></i>
                <span>城市</span>
              </div>
              <div class="card-item-control">
                <span class="value-text">天津</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>

            <!-- 套内面积 -->
            <div class="card-item" data-type="area" data-default="100">
              <div class="card-item-label">
                <i class="fas fa-ruler-combined"></i>
                <span>套内面积</span>
              </div>
              <div class="card-item-control area-input-control">
                <input type="number" class="area-input" value="100" min="1" max="1000">
                <span class="unit-text">㎡</span>
              </div>
            </div>
            
            <!-- 户型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-home"></i>
                <span>户型</span>
              </div>
              <div class="stepper-container">
                <div class="stepper">
                  <span class="stepper-label">房</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="room">-</button>
                    <span class="stepper-value" data-type="room" data-default="3">3</span>
                    <button class="stepper-btn" data-action="plus" data-target="room">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厅</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="hall">-</button>
                    <span class="stepper-value" data-type="hall" data-default="2">2</span>
                    <button class="stepper-btn" data-action="plus" data-target="hall">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">卫</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="bathroom">-</button>
                    <span class="stepper-value" data-type="bathroom" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="bathroom">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厨</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="kitchen">-</button>
                    <span class="stepper-value" data-type="kitchen" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="kitchen">+</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- 装修类型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-brush"></i>
                <span>装修类型</span>
              </div>
              <div class="segmented-control-new" data-type="renovationType">
                <button class="segmented-btn-new active" data-value="精装房">精装房</button>
                <button class="segmented-btn-new" data-value="简装房">简装</button>
                <button class="segmented-btn-new" data-value="毛坯房">毛坯</button>
                <button class="segmented-btn-new" data-value="旧房翻新">翻新</button>
              </div>
            </div>

            <!-- 主操作按钮 -->
            <div class="card-action-footer">
              <button class="send-btn-new primary">
                <i class="fas fa-magic"></i>
                <span>获取AI报价</span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- 成品家具模板 -->
        <div id="furniture-template" class="pricing-template hidden">
          <div class="pricing-card-new">
            <!-- 城市 -->
            <div class="card-item" data-type="city" data-title="城市" data-default="天津">
              <div class="card-item-label">
                <i class="fas fa-map-marker-alt"></i>
                <span>城市</span>
              </div>
              <div class="card-item-control">
                <span class="value-text">天津</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>

            <!-- 套内面积 -->
            <div class="card-item" data-type="area" data-default="100">
              <div class="card-item-label">
                <i class="fas fa-ruler-combined"></i>
                <span>套内面积</span>
              </div>
              <div class="card-item-control area-input-control">
                <input type="number" class="area-input" value="100" min="1" max="1000">
                <span class="unit-text">㎡</span>
              </div>
            </div>
            
            <!-- 户型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-home"></i>
                <span>户型</span>
              </div>
              <div class="stepper-container">
                <div class="stepper">
                  <span class="stepper-label">房</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="room">-</button>
                    <span class="stepper-value" data-type="room" data-default="3">3</span>
                    <button class="stepper-btn" data-action="plus" data-target="room">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厅</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="hall">-</button>
                    <span class="stepper-value" data-type="hall" data-default="2">2</span>
                    <button class="stepper-btn" data-action="plus" data-target="hall">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">卫</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="bathroom">-</button>
                    <span class="stepper-value" data-type="bathroom" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="bathroom">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厨</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="kitchen">-</button>
                    <span class="stepper-value" data-type="kitchen" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="kitchen">+</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- 装修类型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-brush"></i>
                <span>装修类型</span>
              </div>
              <div class="segmented-control-new" data-type="renovationType">
                <button class="segmented-btn-new active" data-value="精装房">精装房</button>
                <button class="segmented-btn-new" data-value="简装房">简装</button>
                <button class="segmented-btn-new" data-value="毛坯房">毛坯</button>
                <button class="segmented-btn-new" data-value="旧房翻新">翻新</button>
              </div>
            </div>

            <!-- 主操作按钮 -->
            <div class="card-action-footer">
              <button class="send-btn-new primary">
                <i class="fas fa-magic"></i>
                <span>获取AI报价</span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- 全屋家电模板 -->
        <div id="appliance-template" class="pricing-template hidden">
          <div class="pricing-card-new">
            <!-- 城市 -->
            <div class="card-item" data-type="city" data-title="城市" data-default="天津">
              <div class="card-item-label">
                <i class="fas fa-map-marker-alt"></i>
                <span>城市</span>
              </div>
              <div class="card-item-control">
                <span class="value-text">天津</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>

            <!-- 套内面积 -->
            <div class="card-item" data-type="area" data-default="100">
              <div class="card-item-label">
                <i class="fas fa-ruler-combined"></i>
                <span>套内面积</span>
              </div>
              <div class="card-item-control area-input-control">
                <input type="number" class="area-input" value="100" min="1" max="1000">
                <span class="unit-text">㎡</span>
              </div>
            </div>
            
            <!-- 户型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-home"></i>
                <span>户型</span>
              </div>
              <div class="stepper-container">
                <div class="stepper">
                  <span class="stepper-label">房</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="room">-</button>
                    <span class="stepper-value" data-type="room" data-default="3">3</span>
                    <button class="stepper-btn" data-action="plus" data-target="room">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厅</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="hall">-</button>
                    <span class="stepper-value" data-type="hall" data-default="2">2</span>
                    <button class="stepper-btn" data-action="plus" data-target="hall">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">卫</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="bathroom">-</button>
                    <span class="stepper-value" data-type="bathroom" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="bathroom">+</button>
                  </div>
                </div>
                <div class="stepper">
                  <span class="stepper-label">厨</span>
                  <div class="stepper-control">
                    <button class="stepper-btn" data-action="minus" data-target="kitchen">-</button>
                    <span class="stepper-value" data-type="kitchen" data-default="1">1</span>
                    <button class="stepper-btn" data-action="plus" data-target="kitchen">+</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- 装修类型 -->
            <div class="card-item-group">
              <div class="card-item-label full-width">
                <i class="fas fa-brush"></i>
                <span>装修类型</span>
              </div>
              <div class="segmented-control-new" data-type="renovationType">
                <button class="segmented-btn-new active" data-value="精装房">精装房</button>
                <button class="segmented-btn-new" data-value="简装房">简装</button>
                <button class="segmented-btn-new" data-value="毛坯房">毛坯</button>
                <button class="segmented-btn-new" data-value="旧房翻新">翻新</button>
              </div>
            </div>

            <!-- 主操作按钮 -->
            <div class="card-action-footer">
              <button class="send-btn-new primary">
                <i class="fas fa-magic"></i>
                <span>获取AI报价</span>
              </button>
            </div>
          </div>
        </div>
        <!-- 沙发报价模板 -->
        <div id="sofa-template" class="pricing-template hidden">
          <div class="pricing-card-new">
            <div class="card-item" data-type="sofaShape" data-title="沙发形状" data-default="L型">
              <div class="card-item-label"><i class="fas fa-draw-polygon"></i><span>沙发形状</span></div>
              <div class="card-item-control"><span class="value-text">L型</span><i class="fas fa-chevron-right"></i></div>
            </div>
            <div class="card-item">
              <div class="card-item-label"><i class="fas fa-ruler-horizontal"></i><span>长度</span></div>
              <div class="card-item-control length-input-control">
                <input type="number" class="length-input" value="3.2" step="0.1" min="1" max="10">
                <span class="unit-text">米</span>
              </div>
            </div>
            <div class="card-item" data-type="sofaMaterial" data-title="面料材质" data-default="头层牛皮">
              <div class="card-item-label"><i class="fas fa-layer-group"></i><span>面料材质</span></div>
              <div class="card-item-control">
                <span class="value-text">头层牛皮</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>
            <!-- 面料价格区间 - 仅在选择面料后显示 -->
            <div class="card-item" id="materialPriceRange" data-type="materialPriceRange" data-title="价格区间" style="display: none;">
              <div class="card-item-label"><i class="fas fa-tag"></i><span>价格区间</span></div>
              <div class="card-item-control">
                <span class="value-text">10~20元/平方英尺</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>
            
            <!-- 电动功能位 -->
            <div class="card-item">
              <div class="card-item-label"><i class="fas fa-robot"></i><span>电动功能位</span></div>
              <div class="card-item-control stepper">
                <button class="stepper-btn" data-action="minus" data-target="sofaElectricFunction">-</button>
                <span class="stepper-value" data-type="sofaElectricFunction" data-default="0">0</span>
                <button class="stepper-btn" data-action="plus" data-target="sofaElectricFunction">+</button>
                <span class="unit-text">个</span>
              </div>
            </div>

            <!-- 后背茶几 -->
            <div class="card-item">
              <div class="card-item-label"><i class="fas fa-table"></i><span>后背茶几</span></div>
              <div class="card-item-control stepper">
                <button class="stepper-btn" data-action="minus" data-target="sofaHiddenTable">-</button>
                <span class="stepper-value" data-type="sofaHiddenTable" data-default="0">0</span>
                <button class="stepper-btn" data-action="plus" data-target="sofaHiddenTable">+</button>
                <span class="unit-text">个</span>
              </div>
            </div>

            <!-- 隐藏拉床 -->
            <div class="card-item" data-type="sofaPullOutBed" data-title="隐藏拉床" data-default="双人">
              <div class="card-item-label"><i class="fas fa-bed"></i><span>隐藏拉床</span></div>
              <div class="card-item-control">
                <span class="value-text">双人</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>

            <!-- 妃位储物 -->
            <div class="card-item" data-type="sofaHasStorage" data-title="妃位储物" data-default="是">
              <div class="card-item-label"><i class="fas fa-box"></i><span>妃位储物</span></div>
              <div class="card-item-control toggle-value-control">
                <span class="value-text">是</span>
                <i class="fas fa-chevron-right"></i>
              </div>
            </div>

            <div class="card-action-footer">
              <button class="send-btn-new primary"><i class="fas fa-magic"></i><span>获取沙发报价</span></button>
            </div>
          </div>
        </div>
      </div>

      <!-- 预设问题 -->
      <div id="presetQuestions" class="px-1 mt-4 pb-4">
          <!-- <h4 class="text-sm font-semibold text-gray-500 mb-3 text-center tracking-wider">或尝试以下示例</h4> -->
          <div class="space-y-3">
              <button class="preset-question-btn">帮我制定在天津120平米的精装房的装修预算</button>
      
              <button class="preset-question-btn">为120平方米住宅的成品家具与软装部分制定详细的预算</button>
          </div>
      </div>
    </div>
  </main>

  <!-- 聊天模式底部容器，用于固定输入框 -->
  <div id="chatModeFooter" class="fixed bottom-0 left-0 right-0 z-10 hidden shadow-top">
    <!-- 这里会动态添加pills-container和compactInputBar -->
  </div>

  <!-- 输入区遮罩层 -->
  <div id="queryInputOverlay" class="query-input-overlay"></div>

  <!-- Compact Input Bar (Initially Hidden) -->
  <div id="compactInputBar" class="hidden w-full">
    <div id="compactInputClickable" class="rounded-full flex items-center px-4 py-2 shadow-sm cursor-pointer bg-white mx-2">
      <div class="flex-1 ml-1">
        <p id="compactSummaryText" class="text-sm truncate">报价生成</p>
      </div>
      <button id="compactSendBtn" class="p-2 -mr-2 rounded-full send-btn">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>

  <!-- 通用选择器 Picker -->
  <div id="pickerOverlay" class="hidden"></div>
  <div id="pickerContainer" class="hidden">
      <div id="pickerHeader">
          <button id="pickerCancel" class="text-gray-500">取消</button>
          <h4 id="pickerTitle" class="font-semibold">选择选项</h4>
          <button id="pickerConfirm" class="text-blue-500 font-semibold">确定</button>
      </div>
      <div id="pickerOptions">
          <!-- Options will be dynamically inserted here -->
      </div>
    </div>

<!-- 城市选择器 -->
<div id="cityPickerOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
<div id="cityPickerContainer" class="fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-xl transform translate-y-full transition-all duration-300 shadow-lg">
  <div id="cityPickerHeader" class="flex items-center justify-between p-4 border-b border-gray-100">
    <button id="cityPickerCancel" class="text-gray-500">取消</button>
    <h4 class="text-base font-semibold">选择城市</h4>
    <div style="width: 40px;"></div><!-- 占位元素，保持标题居中 -->
  </div>
  <div class="p-4">
    <div class="relative mb-4">
      <div class="flex items-center border rounded-lg px-3 py-2 bg-gray-50">
        <i class="fas fa-search text-gray-400 mr-2"></i>
        <input type="text" id="citySearchInput" class="w-full outline-none bg-transparent" placeholder="搜索城市或拼音">
        <button id="citySearchClear" class="text-gray-400 hidden">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div id="citySearchResults" class="absolute left-0 right-0 bg-white rounded-lg mt-1 shadow-lg max-h-64 overflow-y-auto hidden z-10">
        <!-- 搜索结果将动态插入这里 -->
      </div>
    </div>
    
    <div id="cityPickerContent" class="relative">
      <div class="city-main-content max-h-72 overflow-y-auto pr-7">
        <!-- 定位和最近城市 -->
        <div class="mb-5">
          <div class="flex items-center mb-3">
            <i class="fas fa-map-marker-alt text-red-500 mr-2"></i>
            <span class="text-sm font-medium text-gray-600">当前定位</span>
          </div>
          <button id="locationCity" class="city-btn flex items-center justify-center">
            <i class="fas fa-location-arrow mr-1 text-blue-500"></i>
            <span>天津</span>
          </button>
        </div>

        <!-- 最近使用 -->
        <div class="mb-5" id="recentCities">
          <div class="flex items-center mb-3">
            <i class="fas fa-history text-gray-500 mr-2"></i>
            <span class="text-sm font-medium text-gray-600">最近使用</span>
          </div>
          <div class="flex flex-wrap" id="recentCitiesList">
            <!-- 动态插入最近使用的城市 -->
          </div>
        </div>

        <!-- 热门城市 -->
        <div class="mb-5">
          <div class="flex items-center mb-3">
            <i class="fas fa-fire text-orange-500 mr-2"></i>
            <span class="text-sm font-medium text-gray-600">热门城市</span>
          </div>
          <div class="flex flex-wrap" id="hotCitiesList">
            <!-- 动态插入热门城市 -->
          </div>
        </div>
        
        <!-- 全部城市 -->
        <div>
          <div class="flex items-center mb-3">
            <i class="fas fa-list text-gray-500 mr-2"></i>
            <span class="text-sm font-medium text-gray-600">全部城市</span>
          </div>
          <div id="allCitiesList" class="city-letter-groups">
            <!-- 按字母分组的城市列表 -->
          </div>
        </div>
      </div>
      
      <!-- 右侧字母索引 -->
      <div id="alphabetIndex" class="absolute right-0 top-1/4 bottom-0 flex flex-col justify-center items-center w-7 text-xs">
        <!-- 字母索引将动态插入这里 -->
      </div>
    </div>
  </div>
</div>

<script src="ai-pricing.js"></script>
<script>
  // 添加设置菜单和最近对话功能的JavaScript代码
  document.addEventListener('DOMContentLoaded', function() {
    // 设置菜单项点击事件
    const settingsMenuItem = document.getElementById('settingsMenuItem');
    const settingsPage = document.getElementById('settingsPage');
    const closeSettingsButton = document.getElementById('closeSettingsButton');
    const menuOverlay = document.getElementById('menuOverlay');
    const queryInputContainer = document.getElementById('queryInputContainer');
    
    // 最近对话项
    const recentChatItems = document.querySelectorAll('.recent-chat');
    const viewAllChatsBtn = document.getElementById('viewAllChatsBtn');
    
    // 设置菜单项点击事件
    if (settingsMenuItem) {
      settingsMenuItem.addEventListener('click', function(e) {
        e.preventDefault();
        // 关闭菜单
        closeMenu();
        // 显示设置页面
        if (settingsPage) {
          settingsPage.classList.remove('translate-y-full');
          if (menuOverlay) {
            menuOverlay.classList.remove('hidden');
            menuOverlay.style.opacity = '1';
          }
          document.body.style.overflow = 'hidden';
          
          // 隐藏底部输入区域
          if (queryInputContainer) {
            queryInputContainer.style.display = 'none';
          }
        }
      });
    }
    
    // 关闭设置按钮点击事件
    if (closeSettingsButton) {
      closeSettingsButton.addEventListener('click', function() {
        closeSettingsPage();
      });
    }
    
    // 菜单遮罩层点击事件 - 关闭设置页面
    if (menuOverlay) {
      menuOverlay.addEventListener('click', function() {
        closeSettingsPage();
      });
    }
    
    // 关闭设置页面函数
    function closeSettingsPage() {
      if (settingsPage) {
        settingsPage.classList.add('translate-y-full');
      }
      
      if (menuOverlay && !functionMenu.classList.contains('translate-x-full')) {
        // 如果菜单还是打开的，不要隐藏遮罩
      } else {
        if (menuOverlay) {
          menuOverlay.style.opacity = '0';
          setTimeout(() => {
            menuOverlay.classList.add('hidden');
          }, 300);
        }
      }
      
      document.body.style.overflow = '';
      
      // 恢复显示底部输入区域
      if (queryInputContainer) {
        queryInputContainer.style.display = '';
      }
    }
    
    // 设置项点击事件 - 使用事件委托优化性能
    const settingsContent = document.querySelector('#settingsPage .flex-1.overflow-y-auto');
    if (settingsContent) {
      settingsContent.addEventListener('click', function(e) {
        // 找到最近的设置项
        const settingItem = e.target.closest('.settings-item');
        if (!settingItem) return;
        
        // 排除开关类型的设置项
        if (settingItem.querySelector('.toggle-switch')) {
          // 如果点击的是开关本身，不执行额外操作
          if (e.target.closest('.toggle-switch')) return;
        }
        
        const title = settingItem.querySelector('.settings-item-title').textContent;
        
        // 显示提示信息
        showToast(`${title}设置选项`);
      });
    }
    
    // 开关按钮事件 - 使用事件委托
    if (settingsContent) {
      settingsContent.addEventListener('change', function(e) {
        if (!e.target.matches('.toggle-switch input')) return;
        
        const settingName = e.target.closest('.settings-item').querySelector('.settings-item-title').textContent;
        const status = e.target.checked ? '已开启' : '已关闭';
        showToast(`${settingName}${status}`);
        
        // 深色模式特殊处理
        if (e.target.id === 'darkModeToggle') {
          if (e.target.checked) {
            document.documentElement.classList.add('dark-mode');
          } else {
            document.documentElement.classList.remove('dark-mode');
          }
        }
      });
    }
    
    // 最近对话项点击事件
    recentChatItems.forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        
        // 关闭菜单
        closeMenu();
        
        // 显示提示信息
        const chatTitle = this.querySelector('.font-medium').textContent;
        showToast(`打开对话：${chatTitle}`);
        
        // 在实际应用中，这里应该跳转到对应的聊天页面
        setTimeout(() => {
          window.location.href = 'ai-assistant.html';
        }, 500);
      });
    });
    
    // 查看更多历史对话按钮点击事件
    if (viewAllChatsBtn) {
      viewAllChatsBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        // 关闭菜单
        closeMenu();
        
        // 显示提示信息
        showToast('查看全部历史对话');
        
        // 在实际应用中，这里应该跳转到历史对话页面
      });
    }
    
    // 显示Toast提示
    function showToast(message) {
      // 创建toast元素
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      toast.style.position = 'fixed';
      toast.style.bottom = '80px';
      toast.style.left = '50%';
      toast.style.transform = 'translateX(-50%)';
      toast.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
      toast.style.color = 'white';
      toast.style.padding = '8px 16px';
      toast.style.borderRadius = '20px';
      toast.style.fontSize = '14px';
      toast.style.zIndex = '1000';
      
      // 添加到body
      document.body.appendChild(toast);
      
      // 2秒后移除
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.5s ease';
        setTimeout(() => {
          document.body.removeChild(toast);
        }, 500);
      }, 2000);
    }
    
    // 获取菜单元素
    const menuButton = document.getElementById('menuButton');
    const closeMenuButton = document.getElementById('closeMenuButton');
    const functionMenu = document.getElementById('functionMenu');
    
    // 关闭菜单函数
    function closeMenu() {
      menuOverlay.classList.remove('opacity-100');
      setTimeout(() => {
        functionMenu.classList.add('translate-x-full');
        menuOverlay.classList.add('hidden');
        document.body.style.overflow = ''; // 恢复滚动
        
        // 恢复显示底部输入区域
        if (queryInputContainer) {
          queryInputContainer.style.display = '';
        }
      }, 300);
    }
  });
</script>
  
</body>
</html> 